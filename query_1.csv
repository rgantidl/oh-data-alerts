Title,description,Plot_type,Query
DC Touch Point distribution,DC_Enriched,bar,"
SELECT
  date,0 as count 
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (event_time as DATE)
  FROM
    `{client}.dc.enriched_2019*`
  WHERE
    cast(event_time  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  DATE(event_time ) as day,
  COUNT(*) count
FROM
  `{client}.dc.enriched_2019*`
WHERE
  DATE(event_time ) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1"
DCM Cost Data,DCM_Cost,bar,"
SELECT
  date,0 as count
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (date as DATE)
  FROM
  `{client}.dcm.cost_2019*`
  WHERE
    cast(date  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
   CAST(date AS DATE) AS date,
  COUNT(*) count
FROM
  `{client}.dcm.cost_2019*`
WHERE
  CAST(date AS DATE) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY 1"