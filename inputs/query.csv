table,title,plot_type,metric_type,query
dc_enriched,DC Number of Touch Points/day,bar,count,"SELECT
 date,0 as count
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.dc.enriched_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) as date,
 COUNT(*) count
 FROM
 `{client}.dc.enriched_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 ORDER BY
 1"
dcm_cost,DCM Cost Data,bar,count,"SELECT
 date,0 as count
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 DISTINCT parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.dcm.cost_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) AS date,
 COUNT(*) count
 FROM
 `{client}.dcm.cost_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 ORDER BY 1"
dcm_enriched,DCM_enrich Data,bar,count,"SELECT
 date,0 as count
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 DISTINCT parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.enriched_cost_data.dcm_enriched_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) as date,
 COUNT(*) count
 FROM
 `{client}.enriched_cost_data.dcm_enriched_*`
 WHERE
 _table_suffix between '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 ORDER BY
 1"
dcm_cost,DCM Spend,bar,spend,"SELECT
 date,0 as spend
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.dcm.cost_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) as date,
 sum(mediaCost) spend
 FROM
 `{client}.dcm.cost_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 ORDER BY
 1"
dcm_enriched,DCM_enriched spend,bar,spend,"SELECT
 date,0 as spend
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 DISTINCT parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.enriched_cost_data.dcm_enriched_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) as date,
 sum(media_cost) as spend
 FROM
 `{client}.enriched_cost_data.dcm_enriched_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 ORDER BY
 1"
facebook_cost,Facebook Cost Data,bar,count,"SELECT
 date,0 as count
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 DISTINCT parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.facebook.cost_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) AS date,
 COUNT(*) count
 FROM
 `{client}.facebook.cost_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 order by 1"
facebook_enriched,Facebook Cost enriched,bar,count,"SELECT
 date,0 as count
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.enriched_cost_data.facebook_enriched_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) as date,
 COUNT(*) count
 FROM
 `{client}.enriched_cost_data.facebook_enriched_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 ORDER BY
 1"
facebook_cost,Facebook Spend,bar,spend,"SELECT
 date,0 as spend
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.facebook.cost_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 CAST(date_start AS DATE) as date,
 sum(spend) as spend
 FROM
 `{client}.facebook.cost_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 ORDER BY
 1"
facebook_enriched,Facebook enriched spend,bar,spend,"SELECT
 date,0 as spend
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 DISTINCT parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.enriched_cost_data.facebook_enriched_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) as date,
 sum(media_cost) as spend
 FROM
 `{client}.enriched_cost_data.facebook_enriched_*`
 WHERE
 _table_suffix between'{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 ORDER BY
 1"
facebook_exposure,Facebook Exposure Data,bar,count,"SELECT
 date,0 as count
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.facebook.exposure_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) AS date,
 COUNT(*) AS count
 FROM
 `{client}.facebook.exposure_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 ORDER BY
 1"
facebook_sync,Facebook Sync Data,bar,count,"SELECT
 date,0 as count
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 DISTINCT parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.facebook.sync_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) AS date,
 COUNT(*) AS count
 FROM
 `{client}.facebook.sync_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 ORDER BY
 1"
kenshoo_cost,Kenshoo search Data,bar,count,"SELECT
 date,0 as count
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.kenshoo.cost_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) AS date,
 COUNT(*) count
 FROM
 `{client}.kenshoo.cost_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 order by 1"
kenshoo_cost,Kenshoo search Spend,bar,spend,"SELECT
 date,0 as spend
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 DISTINCT parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.kenshoo.cost_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) as date,
 sum(cost) spend
 FROM
 `{client}.kenshoo.cost_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 ORDER BY
 1"
kenshoo_display,Kenshoo display data,bar,spend,"SELECT
 date,0 as spend
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 DISTINCT parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.kenshoo.display_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) as date,
 sum(cost) spend
 FROM
 `{client}.kenshoo.display_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 ORDER BY
 1"
kenshoo_display,Kenshoo display Spend,bar,spend,"SELECT
 date,0 as spend
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 DISTINCT parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.kenshoo.display_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) as date,
 sum(cost) spend
 FROM
 `{client}.kenshoo.display_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 ORDER BY
 1"
adwords_cost,Adwords Cost Data,bar,count,"SELECT
 date,0 as count
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 DISTINCT parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.adwords.cost_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) as date,
 count(*) as count
 FROM
 `{client}.adwords.cost_*`
 WHERE
 _table_suffix between '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 ORDER BY
 1"
adwords_cost,Adwords spend,bar,spend,"SELECT
 date,0 as spend
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 DISTINCT parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.adwords.cost_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) as date,
 sum(Cost) as spend
 FROM
 `{client}.adwords.cost_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 ORDER BY
 1"
adwords_click,Adwords click Data,bar,count,"SELECT
 date,0 as count
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 DISTINCT parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.adwords.click_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) as date,
 count(*) as count
 FROM
 `{client}.adwords.click_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 ORDER BY
 1"
adwords_campaign,Adwords campaign Data,bar,count,"SELECT
 date,0 as count
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 DISTINCT parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.adwords.campaign_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) as date,
 count(*) as count
 FROM
 `{client}.adwords.campaign_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 ORDER BY
 1"
bing_cost,Bing Data,bar,count,"SELECT
 date,0 as count
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 DISTINCT parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.bing.cost_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) as date,
 count(*) as count
 FROM
 `{client}.bing.cost_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 ORDER BY
 1"
bing_cost,Bing Spend,bar,spend,"SELECT
 date,0 as spend
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 DISTINCT parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.bing.cost_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) as date,
 count(*) as cnt
 FROM
 `{client}.bing.cost_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 ORDER BY
 1"
criteo_cost,Criteo Data,bar,count,"SELECT
 date,0 as count
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 DISTINCT parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.criteo.cost_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) as date,
 count(*) as count
 FROM
 `{client}.criteo.cost_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 ORDER BY
 1"
criteo_cost,Criteo Spend,bar,spend,"SELECT
 date,0 as spend
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 DISTINCT parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.criteo.cost_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) as date,
 sum(cost) as spend
 FROM
 `{client}.criteo.cost_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 ORDER BY
 1"
dcm_search_ads_campaign,Search Ads Campaign Data,bar,count,"SELECT
 date,0 as count
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 DISTINCT parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.dcm.search_ads_campaign_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) as date,
 count(*) as count
 FROM
 `{client}.dcm.search_ads_campaign_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 ORDER BY
 1"
search_ads_enriched,Search Ads enriched data,bar,count,"SELECT
 date,0 as count
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 DISTINCT parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.enriched_cost_data.search_ads_enriched_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) as date,
 COUNT(*) count
 FROM
 `{client}.enriched_cost_data.search_ads_enriched_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 ORDER BY
 1"
dcm_search_ads_campaign,Search Ads campaign spend,bar,spend,"SELECT
 date,0 as spend
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 DISTINCT parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.dcm.search_ads_campaign_*`
 WHERE
 _table_suffix between '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) as date,
 SUM(cost) as spend
 FROM
 `{client}.dcm.search_ads_campaign_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 ORDER BY
 1"
search_ads_enriched,Search Ads enriched Spend,bar,spend,"SELECT
 date,0 as spend
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 DISTINCT parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.enriched_cost_data.search_ads_enriched_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) as date,
 sum(media_cost) as spend
 FROM
 `{client}.enriched_cost_data.search_ads_enriched_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 ORDER BY
 1"
dcm_search_ads_keyword,Search Ads Keyword Data,bar,count,"SELECT
 date,0 as count
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 DISTINCT parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.dcm.search_ads_keyword_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) as date,
 count(*) as count
 FROM
 `{client}.dcm.search_ads_keyword_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 ORDER BY
 1"
shopping_enriched,shopping Enriched data,bar,count,"SELECT
 date,0 as count
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 DISTINCT parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.enriched_cost_data.shopping_enriched_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) as date,
 COUNT(*) count
 FROM
 `{client}.enriched_cost_data.shopping_enriched_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 ORDER BY
 1"
dcm_search_ads_keyword,Search Ads Keyword spend,bar,spend,"SELECT
 date,0 as spend
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 DISTINCT parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.dcm.search_ads_keyword_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) as date,
 SUM(cost) as spend
 FROM
 `{client}.dcm.search_ads_keyword_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 ORDER BY
 1"
shopping_enriched,Shopping Enriched cost,bar,spend,"SELECT
 date,0 as spend
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 DISTINCT parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.enriched_cost_data.shopping_enriched_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) as date,
 sum(media_cost) as spend
 FROM
 `{client}.enriched_cost_data.shopping_enriched_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 ORDER BY
 1"
email_enriched,Email cost,bar,spend,"SELECT
 date,0 as spend
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 DISTINCT parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.enriched_cost_data.email_enriched_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) as date,
 SUM(media_cost ) as spend
 FROM
 `{client}.enriched_cost_data.email_enriched_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 ORDER BY
 1"
cost_merged,Cost Merged Data,bar,count,"SELECT
 date,0 as count
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 DISTINCT parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.enriched_cost_data.cost_merged_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) as date,
 COUNT(*) count
 FROM
 `{client}.enriched_cost_data.cost_merged_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 ORDER BY
 1"
aggregated_cost,Aggregated Cost data,bar,count,"SELECT
 date,0 as count
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 DISTINCT parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.enriched_cost_data.aggregated_cost_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) as date,
 COUNT(*) count
 FROM
 `{client}.enriched_cost_data.aggregated_cost_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 GROUP BY
 1
 ORDER BY
 1"
pathing_paths,Conversions Per Day,bar,conversions,"SELECT
 date,0 as conversions
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 DISTINCT parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.pathing.paths_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) as date,
 COUNT(DISTINCT path_id) as conversions
 FROM
 `{client}.pathing.paths_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 AND channel NOT IN('internal')
 GROUP BY 1
 ORDER BY
 1"
pathing_paths,Conversions Per Day Per channel,stack,conversions,"SELECT
 date,NULL as channel,0 as conversions
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 DISTINCT parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.pathing.paths_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) as date,
 channel,
 COUNT(DISTINCT path_id) as conversions
 FROM
 `{client}.pathing.paths_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 AND channel NOT IN('internal')
 GROUP BY
 1,2
 ORDER BY
 1"
pathing_paths,Path Length Distribution,bar,path,"SELECT
 path_length ,
 COUNT(DISTINCT path_id) count
 FROM
 `{client}.pathing.paths_*`
 WHERE
 DATE(event_time ) =DATE_SUB(current_date(), INTERVAL 4 DAY)
 AND channel NOT IN('internal')
 GROUP BY
 1
 ORDER BY
 1"
pathing_paths,Path Length Distribution per channel,stack,path,"SELECT
 path_length,
 channel,
 COUNT(DISTINCT path_id) count
 FROM
 `{client}.pathing.paths_*`
 WHERE
 DATE(event_time )=DATE_SUB(current_date(), INTERVAL 4 DAY)
 AND channel NOT IN('internal')
 --and path_length <50
 GROUP BY
 1,2
 ORDER BY
 1,2"
aggregated_cost,Spend Per day per channel,stack,spend,"SELECT
 parse_date('%Y%m%d', _table_suffix) as date,
 channel,
 SUM(media_cost) spend
 FROM
 `{client}.enriched_cost_data.aggregated_cost_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 AND channel NOT IN('internal')
 GROUP BY
 1,
 2
 ORDER BY
 1,
 2"
aggregated_cost_revenue,Revenue Per day,bar,rev,"SELECT
 date,0 as rev
 FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
 where date not in ( SELECT
 DISTINCT parse_date('%Y%m%d', _table_suffix) as st
 FROM
 `{client}.enriched_cost_data.aggregated_cost_revenue_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}')
 group by 1
 union all
 SELECT
 parse_date('%Y%m%d', _table_suffix) as date,
 SUM(revenue_weighted ) as rev
 FROM
 `{client}.enriched_cost_data.aggregated_cost_revenue_*`
 WHERE
 _table_suffix BETWEEN '{start_date_string}'
 AND '{end_date_string}'
 AND channel NOT IN('internal')
 GROUP BY
 1
 ORDER BY
 1"
Pathing_paths,Null V/S Total campaign for channel paid search,pie,path,"SELECT
 'null_campaign' as campaign,
 COUNT(*) as count,
 channel
 FROM
 `{client}.pathing.paths_*`
 WHERE
 campaign_name IS NULL and DATE(event_time)=DATE_SUB(current_date(), INTERVAL 4 DAY)
 and channel ='paid search'
 group by channel
 UNION ALL
 SELECT
 'total_campaign' as campaign,
 COUNT(*),channel
 FROM
 `{client}.pathing.paths_*`
 WHERE
 1=1 and DATE(event_time)=DATE_SUB(current_date(), INTERVAL 4 DAY)
 and channel ='paid search'
 group by channel
 UNION ALL
 SELECT
 'empty_campaign' as campaign,
 COUNT(*),channel
 FROM
 `{client}.pathing.paths_*`
 WHERE
 campaign_name ='' and DATE(event_time)=DATE_SUB(current_date(), INTERVAL 4 DAY)
 and channel ='paid search'
 group by channel"
pathing_paths,Null V/S Total campaign for channel paid social,pie,path,"SELECT
 'null_campaign' as campaign,
 COUNT(*) as count,
 channel
 FROM
 `{client}.pathing.paths_*`
 WHERE
 campaign_name IS NULL and DATE(event_time)=DATE_SUB(current_date(), INTERVAL 4 DAY)
 and channel ='paid social'
 group by channel
 UNION ALL
 SELECT
 'total_campaign' as campaign,
 COUNT(*),channel
 FROM
 `{client}.pathing.paths_*`
 WHERE
 1=1 and DATE(event_time)=DATE_SUB(current_date(), INTERVAL 04 DAY)
 and channel ='paid social'
 group by channel
 UNION ALL
 SELECT
 'empty_campaign' as campaign,
 COUNT(*),channel
 FROM
 `{client}.pathing.paths_*`
 WHERE
 campaign_name ='' and DATE(event_time)=DATE_SUB(current_date(), INTERVAL 04 DAY)
 and channel ='paid social'
 group by channel"
pathing_paths,Null V/S Total campaign for channel Display,pie,path,"SELECT
 'null_campaign' as campaign,
 COUNT(*) as count,
 channel
 FROM
 `{client}.pathing.paths_*`
 WHERE
 campaign_name IS NULL and DATE(event_time)=DATE_SUB(current_date(), INTERVAL 04 DAY)
 and channel ='display'
 group by channel
 UNION ALL
 SELECT
 'total_campaign' as campaign,
 COUNT(*),channel
 FROM
 `{client}.pathing.paths_*`
 WHERE
 1=1 and DATE(event_time)=DATE_SUB(current_date(), INTERVAL 04 DAY)
 and channel ='display'
 group by channel
 UNION ALL
 SELECT
 'empty_campaign' as campaign,
 COUNT(*),channel
 FROM
 `{client}.pathing.paths_*`
 WHERE
 campaign_name ='' and DATE(event_time)=DATE_SUB(current_date(), INTERVAL 04 DAY)
 and channel ='display'
 group by channel"
pathing_paths,Null V/S Total campaign other,pie,path,"SELECT
 'null_campaign' as campaign,
 COUNT(*) as count,
 channel
 FROM
 `{client}.pathing.paths_*`
 WHERE
 campaign_name IS NULL and DATE(event_time)=DATE_SUB(current_date(), INTERVAL 04 DAY)
 and channel not in ('display','paid social','paid search')
 group by channel
 UNION ALL
 SELECT
 'total_campaign' as campaign,
 COUNT(*),channel
 FROM
 `{client}.pathing.paths_*`
 WHERE
 1=1 and DATE(event_time)=DATE_SUB(current_date(), INTERVAL 04 DAY)
 and channel not in ('display','paid social','paid search')
 group by channel
 UNION ALL
 SELECT
 'empty_campaign' as campaign,
 COUNT(*),channel
 FROM
 `{client}.pathing.paths_*`
 WHERE
 campaign_name ='' and DATE(event_time)=DATE_SUB(current_date(), INTERVAL 04 DAY)
 and channel not in ('display','paid social','paid search')
 group by channel"