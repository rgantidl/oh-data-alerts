Title,Description,Plot_type,column,Query
Spend Per day per channel,Aggregated_cost,stack,spend,"
SELECT
  parse_date('%Y%m%d', _table_suffix) as date,
  channel,
  SUM(media_cost) spend
FROM
  `{client}.enriched_cost_data.aggregated_cost_*`
WHERE
  _table_suffix BETWEEN '{start_date_string}'
  AND '{end_date_string}'
  AND channel NOT IN('internal')
GROUP BY
  1,
  2
ORDER BY
  1,
  2"

Revenue Per day,Aggregated_cost,bar,rev,"
SELECT
  date,0 as rev
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT parse_date('%Y%m%d', _table_suffix) as st
  FROM
    `{client}.enriched_cost_data.aggregated_cost_revenue_*`
  WHERE
    _table_suffix BETWEEN '{start_date_string}'
  AND '{end_date_string}')
  group by 1
  union all
SELECT
  parse_date('%Y%m%d', _table_suffix) as date,
  SUM(revenue_weighted ) as rev
FROM
  `{client}.enriched_cost_data.aggregated_cost_revenue_*`
WHERE
 _table_suffix BETWEEN '{start_date_string}'
  AND '{end_date_string}'
  AND channel NOT IN('internal')
GROUP BY
  1
ORDER BY
  1"
