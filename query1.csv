Title,Description,Plot_type,column,Query
Facebook Spend,Fcebook_Cost,bar,count,"
SELECT
  date,0 as spend
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT parse_date('%Y%m%d', _table_suffix)
  FROM
    `{client}.facebook.cost_*`
  WHERE
    parse_date('%Y%m%d', _table_suffix) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
     parse_date('%Y%m%d', _table_suffix) as date,
  sum(spend) as spend
FROM
  `{client}.facebook.cost_*`
WHERE
  parse_date('%Y%m%d', _table_suffix) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1"
Facebook Exposure Data,Facebook_Exposure,bar,count,"
SELECT
  date,0 as count
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
   parse_date('%Y%m%d', _table_suffix)
  FROM
    `{client}.facebook.exposure_enriched_*`
  WHERE
    parse_date('%Y%m%d', _table_suffix) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  parse_date('%Y%m%d', _table_suffix) AS date,
  COUNT(*) AS count
FROM
  `{client}.facebook.exposure_enriched_*`
WHERE
  parse_date('%Y%m%d', _table_suffix) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1"
Adwords Spend,Adwords_cost,bar,spend,"
SELECT
  date,0 as spend
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    parse_date('%Y%m%d', _table_suffix)
  FROM
    `{client}.adwords.cost_*`
  WHERE
    parse_date('%Y%m%d', _table_suffix) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  parse_date('%Y%m%d', _table_suffix) as date,
   sum(cost) as spend
FROM
  `{client}.adwords.cost_*`
WHERE
  parse_date('%Y%m%d', _table_suffix) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1"
