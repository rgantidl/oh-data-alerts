Title,Description,Plot_type,column,Query
DC Touch Point distribution,DC_Enriched,bar,count,"
SELECT
  date,0 as count 
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (event_time as DATE)
  FROM
    `{client}.dc.enriched_*`
  WHERE
    cast(event_time  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  DATE(event_time ) as day,
  COUNT(*) count
FROM
  `{client}.dc.enriched_*`
WHERE
  DATE(event_time ) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1"
DCM Cost Data,DCM_Cost,bar,count,"
SELECT
  date,0 as count
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (date as DATE)
  FROM
  `{client}.dcm.cost_*`
  WHERE
    cast(date  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
   CAST(date AS DATE) AS date,
  COUNT(*) count
FROM
  `{client}.dcm.cost_*`
WHERE
  CAST(date AS DATE) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY 1"
DCM_enrich Data,DCM_enriched,bar,count,"
SELECT
  date,0 as count 
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (event_time as DATE)
  FROM
    `{client}.enriched_cost_data.dcm_enriched_*`
  WHERE
    cast(event_time  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  DATE(event_time ) as day,
  COUNT(*) count
FROM
  `{client}.enriched_cost_data.dcm_enriched_*`
WHERE
  DATE(event_time ) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1"
DCM Spend,DCM_Cost,bar,spend,"
SELECT
  date,0 as spend
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (date as DATE)
  FROM
    `{client}.dcm.cost_*`
  WHERE
    cast(date  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  CAST(date AS DATE) as date,
  sum(mediaCost) spend
FROM
  `{client}.dcm.cost_*`
WHERE
  CAST (date AS DATE ) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1"
DCM_enriched spend,DCM_enriched,bar,spend,"
SELECT
  date,0 as spend 
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (event_time as DATE)
  FROM
    `{client}.enriched_cost_data.dcm_enriched_*`
  WHERE
    cast(event_time  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  DATE(event_time ) as day,
  sum(media_cost) as spend
FROM
  `{client}.enriched_cost_data.dcm_enriched_*`
WHERE
  DATE(event_time ) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1"
Facebook Cost Data,Facebook_Cost,bar,count,"
SELECT
  date,0 as count
FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (date_start as DATE)
  FROM
    `{client}.facebook.cost_*`
  WHERE
    cast(date_start  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  CAST(date_start  AS DATE) AS date,
  COUNT(*) count
FROM
  `{client}.facebook.cost_*`
WHERE
  CAST(date_start  AS DATE) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
order by 1"
Facebook Cost enriched,Facebook_enriched,bar,count,"
SELECT
  date,0 as count 
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (event_time as DATE)
  FROM
    `{client}.enriched_cost_data.facebook_enriched_*`
  WHERE
    cast(event_time  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  DATE(event_time ) as day,
  COUNT(*) count
FROM
  `{client}.enriched_cost_data.facebook_enriched_*`
WHERE
  DATE(event_time ) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1
  "
Facebook Spend,Fcebook_Cost,bar,spend,"
SELECT
  date,0 as spend
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (date_start as DATE)
  FROM
    `{client}.facebook.cost_*`
  WHERE
    cast(date_start  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
     CAST(date_start  AS DATE) as date,
  sum(spend) as spend
FROM
  `{client}.facebook.cost_*`
WHERE
  CAST (date_start  AS DATE ) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1"
Facebook enriched spend,Facebook_enriched,bar,spend,"
SELECT
  date,0 as spend 
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (event_time as DATE)
  FROM
    `{client}.enriched_cost_data.facebook_enriched_*`
  WHERE
    cast(event_time  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  DATE(event_time ) as day,
  sum(media_cost) as spend
FROM
  `{client}.enriched_cost_data.facebook_enriched_*`
WHERE
  DATE(event_time ) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1
  "
Facebook Exposure Data,Facebook_Exposure,bar,count,"
SELECT
  date,0 as count
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (event_time as DATE)
  FROM
    `{client}.facebook.exposure_enriched_*`
  WHERE
    cast(event_time  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  CAST(event_time AS DATE) AS date,
  COUNT(*) AS count
FROM
  `{client}.facebook.exposure_enriched_*`
WHERE
  CAST(event_time AS DATE) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1"
Facebook Sync Data,Facebook_sync,bar,count,"
SELECT
  date,0 as count
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (date_start as DATE)
  FROM
    `{client}.facebook.sync_*`
  WHERE
    cast(date_start  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  CAST(date_start AS DATE) AS date,
  COUNT(*) AS count
FROM
  `{client}.facebook.sync_*`
WHERE
  CAST(date_start AS DATE) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1"
Kenshoo search Data,Kenshoo_cost,bar,count,"
SELECT
  date,0 as count
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (date as DATE)
  FROM
    `{client}.kenshoo.cost_*`
  WHERE
    cast(date  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  CAST(date   AS DATE) AS date,
  COUNT(*) count
FROM
  `{client}.kenshoo.cost_*`
WHERE
  CAST(date   AS DATE) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
order by 1"
Kenshoo search Spend,Kenshoo_cost,bar,spend,"
SELECT
  date,0 as spend
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (date as DATE)
  FROM
    `{client}.kenshoo.cost_*`
  WHERE
    cast(date  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  CAST(date AS DATE) as date,
  sum(cost) spend
FROM
  `{client}.kenshoo.cost_*`
WHERE
  CAST ( date  AS DATE )BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1"
Kenshoo display data,Kenshoo_display,bar,spend,"
SELECT
  date,0 as spend
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (date as DATE)
  FROM
    `{client}.kenshoo.display_*`
  WHERE
    cast(date  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  CAST(date AS DATE) as date,
  sum(cost) spend
FROM
  `{client}.kenshoo.display_*`
WHERE
  CAST ( date  AS DATE )BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1"
Kenshoo display Spend,Kenshoo_display,bar,spend,"
SELECT
  date,0 as spend
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (date as DATE)
  FROM
    `{client}.kenshoo.cost_*`
  WHERE
    cast(date  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  CAST(date AS DATE) as date,
  sum(cost) spend
FROM
  `{client}.kenshoo.cost_*`
WHERE
  CAST ( date  AS DATE )BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1"
Adwords Cost Data,Adwords_cost,bar,count,"
SELECT
  date,0 as count
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (date as DATE)
  FROM
    `{client}.adwords.cost_*`
  WHERE
    cast(date  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  CAST(date AS DATE) as date,
   count(*) as count
FROM
  `{client}.adwords.cost_*`
WHERE
  CAST ( date  AS DATE ) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1"
Adwords Spend,Adwords_cost,bar,spend,"
SELECT
  date,0 as spend
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (date as DATE)
  FROM
    `{client}.adwords.cost_*`
  WHERE
    cast(date  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  CAST(date AS DATE) as date,
   sum(cost) as spend
FROM
  `{client}.adwords.cost_*`
WHERE
  CAST ( date  AS DATE ) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1"
Bing Data,Bing_cost,bar,count,"
SELECT
  date,0 as count
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (TimePeriod as DATE)
  FROM
    `{client}.bing.cost_*`
  WHERE
    cast(TimePeriod  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  CAST(TimePeriod  AS DATE) as date,
  count(*) as count
FROM
  `{client}.bing.cost_*`
WHERE
  CAST ( TimePeriod   AS DATE ) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1"
Bing Spend,Bing_cost,bar,spend,"
SELECT
  date,0 as spend
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (TimePeriod as DATE)
  FROM
    `{client}.bing.cost_*`
  WHERE
    cast(TimePeriod  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  CAST(TimePeriod  AS DATE) as date,
  count(*) as cnt
FROM
  `{client}.bing.cost_*`
WHERE
  CAST ( TimePeriod   AS DATE )BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1"
Criteo Data,Criteo_cost,bar,count,"
SELECT
  date,0 as count
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (dateTime as DATE)
  FROM
    `{client}.criteo.cost_*`
  WHERE
    cast(dateTime  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  CAST(dateTime  AS DATE) as date,
   count(*) as count
FROM
  `{client}.criteo.cost_*`
WHERE
  CAST ( dateTime    AS DATE ) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1"
Criteo Spend,Criteo_cost,bar,spend,"
SELECT
  date,0 as spend
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (dateTime as DATE)
  FROM
    `{client}.criteo.cost_*`
  WHERE
    cast(dateTime  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  CAST(dateTime  AS DATE) as date,
 sum(cost) as spend
FROM
  `{client}.criteo.cost_*`
WHERE
  CAST ( dateTime    AS DATE ) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1"
Search Ads Campaign Data,DCM_Search_ads_campaign,bar,count,"
SELECT
  date,0 as count
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (date as DATE)
  FROM
    `{client}.dcm.search_ads_campaign_*`
  WHERE
    cast(date  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  CAST(date AS DATE) as date,
  count(*) as count
FROM
  `{client}.dcm.search_ads_campaign_*`
WHERE
  CAST(date AS DATE) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1"
Search Ads enriched data,Search_Ads_enriched,bar,count,"
SELECT
  date,0 as count 
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (event_time as DATE)
  FROM
    `{client}.enriched_cost_data.search_ads_enriched_*`
  WHERE
    cast(event_time  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  DATE(event_time ) as day,
  COUNT(*) count
FROM
  `{client}.enriched_cost_data.search_ads_enriched_*`
WHERE
  DATE(event_time ) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1"
Search Ads campaign spend,DCM_Search_ads_campaign,bar,spend,"
SELECT
  date,0 as spend
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (date as DATE)
  FROM
    `{client}.dcm.search_ads_campaign_*`
  WHERE
    cast(date  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  CAST(date AS DATE) as date,
  SUM(cost) as spend
FROM
  `{client}.dcm.search_ads_campaign_*`
WHERE
  CAST(date AS DATE) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1"
Search Ads enriched Spend,search_ads_enriched,bar,spend,"
SELECT
  date,0 as spend 
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (event_time as DATE)
  FROM
    `{client}.enriched_cost_data.search_ads_enriched_*`
  WHERE
    cast(event_time  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  DATE(event_time ) as day,
  sum(media_cost) as spend
FROM
  `{client}.enriched_cost_data.search_ads_enriched_*`
WHERE
  DATE(event_time ) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1"
Search Ads Keyword Data,DCM_Search_ads_keywords,bar,count,"
SELECT
  date,0 as count
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (date as DATE)
  FROM
    `{client}.dcm.search_ads_keyword_*`
  WHERE
    cast(date  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  CAST(date AS DATE) as date,
  count(*) as count
FROM
  `{client}.dcm.search_ads_keyword_*`
WHERE
  CAST(date AS DATE) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1"
shopping Enriched data,shopping_enriched,bar,count,"
 SELECT
  date,0 as count 
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (event_time as DATE)
  FROM
    `{client}.enriched_cost_data.shopping_enriched_*`
  WHERE
    cast(event_time  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  DATE(event_time ) as day,
  COUNT(*) count
FROM
  `{client}.enriched_cost_data.shopping_enriched_*`
WHERE
  DATE(event_time ) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1
  "
Search Ads Keyword spend,DCM_Search_ads_keywords,bar,spend,"
SELECT
  date,0 as spend
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (date as DATE)
  FROM
    `{client}.dcm.search_ads_keyword_*`
  WHERE
    cast(date  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  CAST(date AS DATE) as date,
  SUM(cost) as spend
FROM
  `{client}.dcm.search_ads_keyword_*`
WHERE
  CAST(date AS DATE) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1"
Shopping Enriched cost,Shopping_enriched,bar,spend,"
 SELECT
  date,0 as spend 
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (event_time as DATE)
  FROM
    `{client}.enriched_cost_data.shopping_enriched_*`
  WHERE
    cast(event_time  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  DATE(event_time ) as day,
  sum(media_cost) as spend
FROM
  `{client}.enriched_cost_data.shopping_enriched_*`
WHERE
  DATE(event_time ) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1
  "
Email cost,Email_Enriched,bar,spend,"
SELECT
  date,0 as spend
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (event_time as DATE)
  FROM
    `{client}.enriched_cost_data.email_enriched_*`
  WHERE
    cast(event_time  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  DATE(event_time ) as date,
  SUM(media_cost ) as spend
FROM
  `{client}.enriched_cost_data.email_enriched_*`
WHERE
  DATE(event_time ) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1"
IXI Data,IXI_Enriched,bar,count,"
SELECT
  date,0 as count
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (event_time as DATE)
  FROM
    `{client}.ixi.transactions_enriched*`
  WHERE
    cast(event_time  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  DATE(event_time ) AS date,
  COUNT(*) AS count
FROM
  `{client}.ixi.transactions_enriched`
WHERE
  DATE(event_time ) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1"
Cost Merged Data,cost_merged,bar,count,"
SELECT
  date,0 as count 
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (event_time as DATE)
  FROM
    `{client}.enriched_cost_data.cost_merged_*`
  WHERE
    cast(event_time  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  DATE(event_time ) as day,
  COUNT(*) count
FROM
  `{client}.enriched_cost_data.cost_merged_*`
WHERE
  DATE(event_time ) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1"
Aggregated Cost data,Aggregated_cost,bar,count,"
SELECT
  date,0 as count 
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (date as DATE)
  FROM
    `{client}.enriched_cost_data.aggregated_cost_*`
  WHERE
    cast(date  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  cast (date as DATE) as day,
  COUNT(*) count
FROM
  `{client}.enriched_cost_data.aggregated_cost_*`
WHERE
  cast (date as DATE) BETWEEN '{start_date}'
  AND '{end_date}'
GROUP BY
  1
ORDER BY
  1"
Conversions Per Day,Pathing_path,bar,conversions,"
SELECT
  date,0 as conversions
FROM
 UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (event_time as DATE)
  FROM
    `{client}.pathing.paths_*`
  WHERE
    cast(event_time  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
   DATE(event_time) as date,
  COUNT(DISTINCT path_id) as conversions
FROM
  `{client}.pathing.paths_*`
WHERE
  DATE(event_time ) BETWEEN '{start_date}'
  AND '{end_date}'
  AND channel NOT IN('internal')
GROUP BY 1
ORDER BY
  1"
Conversions Per Day Per channel,Pathing_path,stack,conversions,"
SELECT
  date,NULL as channel,0 as conversions
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (event_time as DATE)
  FROM
    `{client}.pathing.paths_*`
  WHERE
    cast(event_time  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
   DATE(event_time ) as date,
  channel,
  COUNT(DISTINCT path_id) as conversions
FROM
  `{client}.pathing.paths_*`
WHERE
  DATE(event_time ) BETWEEN '{start_date}'
  AND '{end_date}'
  AND channel NOT IN('internal')
GROUP BY
  1,2
ORDER BY
  1
 "
Path Length Distribution,Pathing_path,bar,path,"SELECT
path_length ,
COUNT(DISTINCT path_id) count  
FROM
  `{client}.pathing.paths_*`
WHERE
  DATE(event_time ) =DATE_SUB(current_date(), INTERVAL 4 DAY)
  AND channel NOT IN('internal')
GROUP BY
  1
ORDER BY
  1 
"
Path Length Distribution per channel,Pathing_path,stack,path,"SELECT
   path_length,
  channel,
  COUNT(DISTINCT path_id) count
FROM
  `{client}.pathing.paths_*`
WHERE
  DATE(event_time )=DATE_SUB(current_date(), INTERVAL 4 DAY)
  AND channel NOT IN('internal')
  --and path_length <50
GROUP BY
  1,2
ORDER BY
  1,2
  "
Spend Per day per channel,Aggregated_cost,stack,spend,"
SELECT
  date,
  channel,
  SUM(media_cost) spend
FROM
  `{client}.enriched_cost_data.aggregated_cost_*`
WHERE
  cast(date  as DATE) BETWEEN '{start_date}'
  AND '{end_date}'
  AND channel NOT IN('internal')
GROUP BY
  1,
  2
ORDER BY
  1,
  2"
Revenue Per day,Aggregated_cost,bar,rev,"
SELECT
  date,0 as rev
FROM
  UNNEST(GENERATE_DATE_ARRAY('{start_date}','{end_date}')) AS date
  where date not in ( SELECT
    DISTINCT cast (date as DATE)
  FROM
    `{client}.enriched_cost_data.aggregated_cost_revenue_*`
  WHERE
    cast(date  as DATE) BETWEEN '{start_date}'
  AND '{end_date}')
  group by 1
  union all
SELECT
  cast(date as DATE ) as date,
  SUM(revenue_weighted ) as rev
FROM
  `{client}.enriched_cost_data.aggregated_cost_revenue_*`
WHERE
  cast(date as DATE ) BETWEEN '{start_date}'
  AND '{end_date}'
  AND channel NOT IN('internal')
GROUP BY
  1
ORDER BY
  1"
Null V/S Total campaign for channel paid search,Pathing_path,pie,path,"SELECT
  'null_campaign' as campaign,
  COUNT(*) as count,
  channel
FROM
  `{client}.pathing.paths_*`
WHERE
  campaign_name IS NULL and DATE(event_time)=DATE_SUB(current_date(), INTERVAL 4 DAY)
  and channel ='paid search'
  group by channel
UNION ALL
SELECT
  'total_campaign' as campaign,
  COUNT(*),channel 
FROM
  `{client}.pathing.paths_*`
WHERE
  1=1 and DATE(event_time)=DATE_SUB(current_date(), INTERVAL 4 DAY)
  and channel ='paid search'
  group by channel
  UNION ALL
SELECT
  'empty_campaign' as campaign,
  COUNT(*),channel
FROM
  `{client}.pathing.paths_*`
WHERE
  campaign_name =''  and DATE(event_time)=DATE_SUB(current_date(), INTERVAL 4 DAY)
  and channel ='paid search'
  group by channel"
  Null V/S Total campaign for channel paid social,Pathing_path,pie,path,"SELECT
  'null_campaign' as campaign,
  COUNT(*) as count,
  channel
FROM
  `{client}.pathing.paths_*`
WHERE
  campaign_name IS NULL and DATE(event_time)=DATE_SUB(current_date(), INTERVAL 4 DAY)
  and channel ='paid social'
  group by channel
UNION ALL
SELECT
  'total_campaign' as campaign,
  COUNT(*),channel 
FROM
 `{client}.pathing.paths_*`
WHERE
  1=1 and DATE(event_time)=DATE_SUB(current_date(), INTERVAL 04 DAY)
  and channel ='paid social'
  group by channel
  UNION ALL
SELECT
  'empty_campaign' as campaign,
  COUNT(*),channel
FROM
`{client}.pathing.paths_*`
WHERE
  campaign_name =''  and DATE(event_time)=DATE_SUB(current_date(), INTERVAL 04 DAY)
  and channel ='paid social'
  group by channel"
  Null V/S Total campaign for channel Display,Pathing_path,pie,path,"SELECT
  'null_campaign' as campaign,
  COUNT(*) as count,
  channel
FROM
  `{client}.pathing.paths_*`
WHERE
  campaign_name IS NULL and DATE(event_time)=DATE_SUB(current_date(), INTERVAL 04 DAY)
  and channel ='display'
  group by channel
UNION ALL
SELECT
  'total_campaign' as campaign,
  COUNT(*),channel 
FROM
  `{client}.pathing.paths_*`
WHERE
  1=1 and DATE(event_time)=DATE_SUB(current_date(), INTERVAL 04 DAY)
  and channel ='display'
  group by channel
  UNION ALL
SELECT
  'empty_campaign' as campaign,
  COUNT(*),channel
FROM
`{client}.pathing.paths_*`
WHERE
  campaign_name =''  and DATE(event_time)=DATE_SUB(current_date(), INTERVAL 04 DAY)
  and channel ='display'
  group by channel"
Null V/S Total campaign other,Pathing_path,pie,path,"SELECT
  'null_campaign' as campaign,
  COUNT(*) as count,
  channel
FROM
  `{client}.pathing.paths_*`
WHERE
  campaign_name IS NULL and DATE(event_time)=DATE_SUB(current_date(), INTERVAL 04 DAY)
  and channel not in ('display','paid social','paid search')
  group by channel
UNION ALL
SELECT
  'total_campaign' as campaign,
  COUNT(*),channel 
FROM
`{client}.pathing.paths_*`
WHERE
  1=1 and DATE(event_time)=DATE_SUB(current_date(), INTERVAL 04 DAY)
  and channel not in ('display','paid social','paid search')
  group by channel
  UNION ALL
SELECT
  'empty_campaign' as campaign,
  COUNT(*),channel
FROM
 `{client}.pathing.paths_*`
WHERE
  campaign_name =''  and DATE(event_time)=DATE_SUB(current_date(), INTERVAL 04 DAY)
  and channel not in ('display','paid social','paid search')
  group by channel"